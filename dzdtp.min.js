"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=Array.prototype.slice,c=function(b,c){var d=function(b){return b.getAttribute("id")===c||b.classList.contains(c)};if(d(b))return b;for(;b.parentNode;){if(b=b.parentNode,b===document.body||b===document)return;if(d(b))return b}},d=function(b){return b&&b.preventDefault&&b.preventDefault(),b.target.blur(),!1},e=function(b){return b&&b.preventDefault&&b.preventDefault(),!1},f=function(){function f(){_classCallCheck(this,f),this.init()}return _createClass(f,[{key:"init",value:function(){return!this.initialized&&(this.initialized=!0,void this.setupHooks())}},{key:"setupHooks",value:function(){var g=this,h=function(b){b&&b.preventDefault&&b.preventDefault();var c=g.getCalendar(),d=c.dataset.current.split("-"),e=new Date(d[0],d[1]),f=new Date(e.getFullYear(),e.getMonth()-1),h=g.drawDates(g.getDaysArrayByMonth(f)),i=document.querySelector("#dz-calendar .dz-dates");c.insertAdjacentHTML("beforeEnd",h),h=c.children[c.children.length-1],c.removeChild(i);var j=f.getFullYear(),l=f.getMonth();return c.dataset.current=j+" - "+l,c.children[0].children[0].innerHTML=g.getMonthName(l)+", "+j,k(),!1},i=function(b){b&&b.preventDefault&&b.preventDefault();var c=g.getCalendar(),d=c.dataset.current.split("-"),e=new Date(d[0],d[1]),f=new Date(e.getFullYear(),e.getMonth()+1),h=g.drawDates(g.getDaysArrayByMonth(f)),i=document.querySelector("#dz-calendar .dz-dates");c.insertAdjacentHTML("beforeEnd",h),h=c.children[c.children.length-1],c.removeChild(i);var j=f.getFullYear(),l=f.getMonth();return c.dataset.current=j+" - "+l,c.children[0].children[0].innerHTML=g.getMonthName(l)+", "+j,k(),!1};this.bodyClick=function(a){var b=g.getCalendar();if(b)if(b.classList.contains("active")){if(!g.isInCalendar(a.target))return g.cleanupCalendar(a,b)}else document.body.removeChild(b)};var j=function(b){var c=g.getCalendar(),d=parseInt(b.target.innerHTML),e=c.dataset.current.split("-");d=new Date(e[0],e[1],d);var f=window[g.source.dataset.onset];f&&f(d);var h=d.getMonth()+1;1===h.toString().length&&(h="0"+h);var i=d.getDate();1===i.toString().length&&(i="0"+i);var j=[d.getFullYear(),h,i].join("-");return"INPUT"===g.source.nodeName?g.source.value=j:g.source.dataset.dateVal&&(g.source.dataset.dateVal=j),g.cleanupCalendar(b,c)},k=function(){var c=g.getCalendar();if(c){var d=b.call(document.querySelectorAll("#dz-calendar .dz-dates div"));d.forEach(function(a){a.classList.contains("disabled")||a.addEventListener("click",j,!1)})}},l=function a(b){var d=g.getCalendar();if(d)return g.cleanupCalendar(b,d),setTimeout(function(){a(b)},300),!1;var e=b.target.getBoundingClientRect(),f={x:e.left+e.width/2,y:e.top+e.height},j=c(b.target,"date-trigger");g.source=j;var l=g.drawCalendar();document.body.insertAdjacentHTML("beforeEnd",l),l=document.getElementById("dz-calendar");var m=l.getBoundingClientRect(),n=4*m.width;l.style.left=f.x-n/2+"px",l.style.top=f.y+16+"px";var o=l.children[0].children[1],p=l.children[0].children[2];o.addEventListener("click",h,!1),p.addEventListener("click",i,!1),l.classList.add("active"),k();var q="didShowDatePicker";return window[q]&&window[q](l),setTimeout(function(){document.body.addEventListener("click",g.bodyClick,!1)},500),!1},m=document.querySelectorAll(".date-trigger");m=b.call(m);var n=function(b){b&&(b.addEventListener("click",l,!1),"INPUT"===b.nodeName&&(b.addEventListener("focus",d,!1),b.addEventListener("blur",e,!1)))};m.forEach(function(a){n(a)}),a.attachDateTrigger=n}},{key:"getCalendar",value:function(){return document.getElementById("dz-calendar")}},{key:"isInCalendar",value:function(b){var d=c(b,"dz-calendar");return d!==document.body&&void 0!=d}},{key:"getMonthName",value:function(b){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].splice(b,1)}},{key:"getDaysArrayByMonth",value:function(b){for(var c=b.getFullYear(),d=b.getMonth(),e=new Date(c,d,0).getDate(),f=[];e>0;)f.push(new Date(c,d,e)),e--;return f.reverse()}},{key:"drawDates",value:function(b){var c=new Date;"INPUT"===this.source.nodeName&&this.source.value?c=new Date(this.source.value):this.source.dataset.dateVal&&(c=new Date(this.source.dataset.dateVal));var d='<div class="dz-dates">',f=(this.getCalendar(),this.source.dataset),g=f.dateMax,h=f.dateMin;g&&(g=new Date(g)),h&&(h=new Date(h));var i=null;"INPUT"===this.source.nodeName?i=new Date(this.source.value):this.source.dataset.dateVal&&(i=new Date(this.source.dataset.dateVal));var j=b[0].getDay(),k=function(b,c){return b.getDate()===c.getDate()&&b.getMonth()===c.getMonth()&&b.getYear()&&c.getYear()};return b.forEach(function(a,b){var e=[];k(c,a)&&e.push("today"),i&&k(a,i)&&e.push("selected"),h&&h.getTime()-a.getTime()>0&&e.push("disabled"),g&&g.getTime()-a.getTime()<0&&e.push("disabled"),e=e.join(" "),d+=0!==b?'<div role="button" class="'+e+'">'+a.getDate()+"</div>":'<div style="margin-left:'+35*j+'px;" role="button" class="'+e+'">'+a.getDate()+"</div>"}),d+="</div>"}},{key:"drawCalendar",value:function(){var b=new Date,c=b.getFullYear(),d=b.getMonth(),e=this.getDaysArrayByMonth(b),f=["S","M","T","W","T","F","S"],g='<div id="dz-calendar" class="inline-container" data-current="'+c+"-"+d+'">\n        <div class="dz-title"> \n           <h4>'+this.getMonthName(b.getMonth())+", "+b.getFullYear()+'</h4>\n           <button id="dz-prev"><</button>\n           <button id="dz-next">></button>\n        </div>\n        <div class="dz-days">';return f.forEach(function(a){g+="<div>"+a+"</div>"}),g+="</div>\n        "+this.drawDates(e)+"\n      </div>"}},{key:"cleanupCalendar",value:function(b,c){var d=this;return b&&b.preventDefault&&b.preventDefault(),c&&(c.classList.remove("active"),setTimeout(function(){document.body.removeChild(c),d.source=void 0},300)),document.body.removeEventListener("click",this.bodyClick,!1),!1}}]),f}(),g=function(){function a(){_classCallCheck(this,a),this.init()}return _createClass(a,[{key:"init",value:function(){return!this.initialized&&(this.initialized=!0,void this.setupHooks())}},{key:"setupHooks",value:function(){var c=this;this.bodyClick=function(a){if("SELECT"===a.target.nodeName)return!1;var b=c.getTimer();if(b)if(b.classList.contains("active")){if(!c.isInTimer(a.target))return c.cleanupTimer(a,b)}else document.body.removeChild(b);document.body.removeEventListener("click",c.bodyClick,!1)};var f=function(){var b=c.getTimer(),d=parseInt(b.children[0].value),e=parseInt(b.children[1].value),f=parseInt(b.children[2].value);1===f&&(d+=12),12===d&&0===f&&(d="00"),"INPUT"===c.source.nodeName&&(c.source.value=d+":"+e);var g=window[c.source.dataset.onchange];g&&g({string:d+":"+e,hours:parseInt(d),minutes:e})},g=function a(d){var e=c.getTimer();if(e)return c.cleanupTimer(d,e),setTimeout(function(){a(d)},300),!1;var g=d.target.getBoundingClientRect(),h={x:g.left+g.width/2,y:g.top+g.height};c.source=d.target;var i=c.drawTimer();if(document.body.insertAdjacentHTML("beforeEnd",i),i=c.getTimer(),"INPUT"!==c.source.nodeName||!c.source.value.length){var j=new Date,k=j.getHours(),l=j.getMinutes();i.children[0].value=k>12?k-12:k,i.children[1].value=l,i.children[2].value=k>=12?1:0}b.call(i.children).forEach(function(a){a.addEventListener("change",f,!1)});var m=i.getBoundingClientRect(),n=4*m.width;return i.style.left=h.x-n/2+"px",i.style.top=h.y+16+"px",i.classList.add("active"),setTimeout(function(){document.body.addEventListener("click",c.bodyClick,!1)},500),!1},h=function(b){b&&(b.addEventListener("click",g,!1),"INPUT"===b.nodeName&&(b.addEventListener("focus",d,!1),b.addEventListener("blur",e,!1)))},i=b.call(document.querySelectorAll(".timer-trigger"));i.forEach(function(a){h(a)}),window.attachTimeTrigger=h}},{key:"getTimer",value:function(){return document.getElementById("dz-timer")}},{key:"isInTimer",value:function(b){var d=c(b,"dz-timer");return d!==document.body&&void 0!=d}},{key:"drawTimer",value:function(){var b=null,c=void 0,d=void 0,e=!1;"INPUT"===this.source.nodeName&&(b=this.source.value),b&&(b=b.split(":"),c=parseInt(b[0]),d=b[1],c>12&&(c-=12,e=!0));var f='<div id="dz-timer" class="inline-container">\n        <select class="hours">',g=Array.from(Array(13).keys());return g.shift(),f+=g.map(function(a){return a===c?"<option value='"+a+"' selected='selected'>"+a+"</option>":"<option value='"+a+"'>"+a+"</option>"}).join(" "),f+='</select>\n        <select class="minutes">',f+=Array.from(Array(60).keys()).map(function(a){return 1===a.toString().length&&(a="0"+a),a.toString()===d?"<option value='"+a+"' selected='selected'>"+a+"</option>":"<option value='"+a+"'>"+a+"</option>"}).join(" "),f+="</select>\n        <select class=\"shift\">\n          <option value='0' "+(e?"":"selected='selected'")+">AM</option>\n          <option value='1' "+(e?"selected='selected'":"")+">PM</option>\n        </select>",f+="</select>\n      </div>"}},{key:"cleanupTimer",value:function(b,c){var d=this;return b&&b.preventDefault&&b.preventDefault(),c&&(c.classList.remove("active"),setTimeout(function(){d.source=void 0,c.parentNode&&document.body.removeChild(c)},300)),document.body.removeEventListener("click",this.bodyClick,!1),!1}}]),a}();a&&a.exports?a.exports={datePicker:new f,timePicker:new g}:(a.DZDatePicker=f,a.DZTimePicker=g,a.datePicker=new f,a.timePicker=new g)}("undefined"==typeof module?window:module);
