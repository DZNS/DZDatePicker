"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){var t=Array.prototype.slice,n=function(e,t){for(;e.parentNode;){if(e=e.parentNode,e===document.body||e===document)return;if(e.getAttribute("id")===t)return e}},r=function(e){return e&&e.preventDefault&&e.preventDefault(),e.target.blur(),!1},a=function(e){return e&&e.preventDefault&&e.preventDefault(),!1},i=function(){function i(){_classCallCheck(this,i),this.init()}return _createClass(i,[{key:"init",value:function(){return this.initialized?!1:(this.initialized=!0,void this.setupHooks())}},{key:"setupHooks",value:function(){var n=this,i=function(e){e&&e.preventDefault&&e.preventDefault();var t=n.getCalendar(),r=t.dataset.current.split("-"),a=new Date(r[0],r[1]),i=new Date(a.getFullYear(),a.getMonth()-1),o=n.drawDates(n.getDaysArrayByMonth(i)),c=t.children[2];t.insertAdjacentHTML("beforeEnd",o),o=t.children[3],t.removeChild(c);var d=i.getFullYear(),u=i.getMonth();return t.dataset.current=d+" - "+u,t.children[0].children[0].innerHTML=n.getMonthName(u)+", "+d,l(),!1},o=function(e){e&&e.preventDefault&&e.preventDefault();var t=n.getCalendar(),r=t.dataset.current.split("-"),a=new Date(r[0],r[1]),i=new Date(a.getFullYear(),a.getMonth()+1),o=n.drawDates(n.getDaysArrayByMonth(i)),c=t.children[2];t.insertAdjacentHTML("beforeEnd",o),o=t.children[3],t.removeChild(c);var d=i.getFullYear(),u=i.getMonth();return t.dataset.current=d+" - "+u,t.children[0].children[0].innerHTML=n.getMonthName(u)+", "+d,l(),!1};this.bodyClick=function(e){var t=n.getCalendar();if(t)if(t.classList.contains("active")){if(!n.isInCalendar(e.target))return n.cleanupCalendar(e,t)}else document.body.removeChild(t);document.body.removeEventListener("click",n.bodyClick,!1)};var c=function(e){var t=n.getCalendar(),r=parseInt(e.target.innerHTML),a=t.dataset.current.split("-");r=new Date(a[0],a[1],r);var i=window[n.source.dataset.onset];i&&i(r);var o=r.getMonth()+1;1===o.toString().length&&(o="0"+o);var c=r.getDate();1===c.toString().length&&(c="0"+c);var l=[r.getFullYear(),o,c].join("-");return"INPUT"===n.source.nodeName?n.source.value=l:n.source.dataset.dateVal&&(n.source.dataset.dateVal=l),n.cleanupCalendar(e,t)},l=function(){var e=n.getCalendar();if(e){var t=[].slice.call(e.children[2].children);t.forEach(function(e){e.classList.contains("disabled")||e.addEventListener("click",c,!1)})}},d=function v(e){var t=n.getCalendar();if(t)return n.cleanupCalendar(e,t),setTimeout(function(){v(e)},300),!1;var r=e.target.getBoundingClientRect(),a={x:r.left+r.width/2,y:r.top+r.height},c=$(e.target).parent("date-trigger");n.source=c;var d=n.drawCalendar();document.body.insertAdjacentHTML("beforeEnd",d),d=document.getElementById("dz-calendar");var u=d.getBoundingClientRect(),s=4*u.width;d.style.left=a.x-s/2+"px",d.style.top=a.y+16+"px";var h=d.children[0].children[1],f=d.children[0].children[2];h.addEventListener("click",i,!1),f.addEventListener("click",o,!1),d.classList.add("active"),l();var g="didShowDatePicker";return window[g]&&window[g](d),setTimeout(function(){document.body.addEventListener("click",n.bodyClick,!1)},500),!1},u=document.querySelectorAll(".date-trigger");u=t.call(u);var s=function(e){e&&(e.addEventListener("click",d,!1),"INPUT"===e.nodeName&&(e.addEventListener("focus",r,!1),e.addEventListener("blur",a,!1)))};u.forEach(function(e){s(e)}),e.attachDateTrigger=s}},{key:"getCalendar",value:function(){return document.getElementById("dz-calendar")}},{key:"isInCalendar",value:function(e){var t=n(e,"dz-calendar");return t!==document.body&&void 0!=t}},{key:"getMonthName",value:function(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].splice(e,1)}},{key:"getDaysArrayByMonth",value:function(e){for(var t=e.getFullYear(),n=e.getMonth(),r=new Date(t,n,0).getDate(),a=[];r>0;)a.push(new Date(t,n,r)),r--;return a.reverse()}},{key:"drawDates",value:function(e){var t=new Date,n='<div class="dz-dates">',r=(this.getCalendar(),this.source.dataset),a=r.dateMax,i=r.dateMin;a&&(a=new Date(a)),i&&(i=new Date(i));var o=null;"INPUT"===this.source.nodeName?o=new Date(this.source.value):this.source.dataset.dateVal&&(o=new Date(this.source.dataset.dateVal));var c=e[0].getDay(),l=function(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getYear()&&t.getYear()};return e.forEach(function(e,r){var d=[];l(t,e)&&d.push("today"),o&&l(e,o)&&d.push("selected"),i&&i.getTime()-e.getTime()>0&&d.push("disabled"),a&&a.getTime()-e.getTime()<0&&d.push("disabled"),d=d.join(" "),n+=0!==r?'<div role="button" class="'+d+'">'+e.getDate()+"</div>":'<div style="margin-left:'+35*c+'px;" role="button" class="'+d+'">'+e.getDate()+"</div>"}),n+="</div>"}},{key:"drawCalendar",value:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=this.getDaysArrayByMonth(e),a=["S","M","T","W","T","F","S"],i='<div id="dz-calendar" class="inline-container" data-current="'+t+"-"+n+'">\n        <div class="dz-title"> \n           <h4>'+this.getMonthName(e.getMonth())+", "+e.getFullYear()+'</h4>\n           <button id="dz-prev"><</button>\n           <button id="dz-next">></button>\n        </div>\n        <div class="dz-days">';return a.forEach(function(e){i+="<div>"+e+"</div>"}),i+="</div>\n        "+this.drawDates(r)+"\n      </div>"}},{key:"cleanupCalendar",value:function(e,t){var n=this;return e&&e.preventDefault&&e.preventDefault(),t&&(t.classList.remove("active"),setTimeout(function(){document.body.removeChild(t),n.source=void 0},300)),document.body.removeEventListener("click",this.bodyClick,!1),!1}}]),i}(),o=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"init",value:function(){return this.initialized?!1:(this.initialized=!0,void this.setupHooks())}},{key:"setupHooks",value:function(){var e=this;this.bodyClick=function(t){if("SELECT"===t.target.nodeName)return!1;var n=e.getTimer();if(n)if(n.classList.contains("active")){if(!e.isInTimer(t.target))return e.cleanupTimer(t,n)}else document.body.removeChild(n);document.body.removeEventListener("click",e.bodyClick,!1)};var n=function(){var t=e.getTimer(),n=parseInt(t.children[0].value),r=parseInt(t.children[1].value),a=parseInt(t.children[2].value);1===a&&(n+=12),12===n&&0===a&&(n="00"),"INPUT"===e.source.nodeName&&(e.source.value=n+":"+r);var i=window[e.source.dataset.onchange];i&&i({string:n+":"+r,hours:parseInt(n),minutes:r})},i=function l(r){var a=e.getTimer();if(a)return e.cleanupTimer(r,a),setTimeout(function(){l(r)},300),!1;var i=r.target.getBoundingClientRect(),o={x:i.left+i.width/2,y:i.top+i.height};e.source=r.target;var c=e.drawTimer();if(document.body.insertAdjacentHTML("beforeEnd",c),c=e.getTimer(),"INPUT"!==e.source.nodeName||!e.source.value.length){var d=new Date,u=d.getHours(),s=d.getMinutes();c.children[0].value=u>12?u-12:u,c.children[1].value=s,c.children[2].value=u>=12?1:0}t.call(c.children).forEach(function(e){e.addEventListener("change",n,!1)});var v=c.getBoundingClientRect(),h=4*v.width;return c.style.left=o.x-h/2+"px",c.style.top=o.y+16+"px",c.classList.add("active"),setTimeout(function(){document.body.addEventListener("click",e.bodyClick,!1)},500),!1},o=function(e){e&&(e.addEventListener("click",i,!1),"INPUT"===e.nodeName&&(e.addEventListener("focus",r,!1),e.addEventListener("blur",a,!1)))},c=t.call(document.querySelectorAll(".timer-trigger"));c.forEach(function(e){o(e)}),window.attachTimeTrigger=o}},{key:"getTimer",value:function(){return document.getElementById("dz-timer")}},{key:"isInTimer",value:function(e){var t=n(e,"dz-timer");return t!==document.body&&void 0!=t}},{key:"drawTimer",value:function(){var e=null,t=void 0,n=void 0,r=!1;"INPUT"===this.source.nodeName&&(e=this.source.value),e&&(e=e.split(":"),t=parseInt(e[0]),n=e[1],t>12&&(t-=12,r=!0));var a='<div id="dz-timer" class="inline-container">\n        <select class="hours">',i=Array.from(Array(13).keys());return i.shift(),a+=i.map(function(e){return e===t?"<option value='"+e+"' selected='selected'>"+e+"</option>":"<option value='"+e+"'>"+e+"</option>"}).join(" "),a+='</select>\n        <select class="minutes">',a+=Array.from(Array(60).keys()).map(function(e){return 1===e.toString().length&&(e="0"+e),e.toString()===n?"<option value='"+e+"' selected='selected'>"+e+"</option>":"<option value='"+e+"'>"+e+"</option>"}).join(" "),a+="</select>\n        <select class=\"shift\">\n          <option value='0' "+(r?"":"selected='selected'")+">AM</option>\n          <option value='1' "+(r?"selected='selected'":"")+">PM</option>\n        </select>",a+="</select>\n      </div>"}},{key:"cleanupTimer",value:function(e,t){var n=this;return e&&e.preventDefault&&e.preventDefault(),t&&(t.classList.remove("active"),setTimeout(function(){n.source=void 0,t.parentNode&&document.body.removeChild(t)},300)),document.body.removeEventListener("click",this.bodyClick,!1),!1}}]),e}();e&&e.exports?e.exports={datePicker:new i,timePicker:new o}:(e.datePicker=new i,e.timePicker=new o)}("undefined"==typeof module?window:module);
