"use strict";const findParent=(e,t)=>{const i=e=>e.getAttribute("id")===t||e.classList.contains(t);if(i(e))return e;for(;e.parentNode;){if((e=e.parentNode)===document.body||e===document)return;if(i(e))return e}},inputFocus=e=>(e&&e.preventDefault&&e.preventDefault(),e.target.blur(),!1),inputBlur=e=>(e&&e.preventDefault&&e.preventDefault(),!1),measure=(e=function(){})=>new Promise((t,i)=>{window.requestAnimationFrame(()=>{const i=e();t(i)})}),mutate=(e=function(){})=>new Promise((t,i)=>{window.requestAnimationFrame(()=>{const i=e();t(i)})});window.wait=window.wait||async function(e=0){return new Promise(t=>{setTimeout(()=>{t()},e)})},(e=>{class t{constructor(e){this.customClass=e,this.init()}init(){if(this.initialized)return!1;this.initialized=!0,this.setupHooks()}setupHooks(){const t=e=>{e&&e.preventDefault&&e.preventDefault();let t=this.getCalendar(),i=t.dataset.current.split("-"),n=new Date(i[0],i[1]),a=new Date(n.getFullYear(),n.getMonth()-1),s=this.drawDates(this.getDaysArrayByMonth(a)),l=document.querySelector("#dz-calendar .dz-dates");t.insertAdjacentHTML("beforeEnd",s),s=t.children[t.children.length-1],t.removeChild(l);let o=a.getFullYear(),d=a.getMonth();return t.dataset.current=`${o} - ${d}`,t.children[0].children[0].innerHTML=`${this.getMonthName(d)}, ${o}`,r(),!1},i=e=>{e&&e.preventDefault&&e.preventDefault();let t=this.getCalendar(),i=t.dataset.current.split("-"),n=new Date(i[0],i[1]),a=new Date(n.getFullYear(),n.getMonth()+1),s=this.drawDates(this.getDaysArrayByMonth(a)),l=document.querySelector("#dz-calendar .dz-dates");t.insertAdjacentHTML("beforeEnd",s),s=t.children[t.children.length-1],t.removeChild(l);let o=a.getFullYear(),d=a.getMonth();return t.dataset.current=`${o} - ${d}`,t.children[0].children[0].innerHTML=`${this.getMonthName(d)}, ${o}`,r(),!1};this.bodyClick=e=>{let t=this.getCalendar();if(t)if(t.classList.contains("active")){if(!this.isInCalendar(e.target))return this.cleanupCalendar(e,t)}else document.body.removeChild(t)},this.bodyInput=e=>{const{keyCode:t}=e,i=this.getCalendar();if(36==t||35==t){const e=i.querySelector(`.dz-dates button:${36==t?"first-child":"last-child"}`);return e&&e.focus(),!0}if(t>=37&&t<=40){let e=Number(document.activeElement.innerHTML)||0;40==t?e+=7:38==t?e-=7:37==t?e-=1:e+=1;const n=i.querySelector(`.dz-dates button:nth-child(${e})`);return n&&n.focus(),!0}return 33==t?(i.querySelector("#dz-prev").click(),!0):34==t?(i.querySelector("#dz-next").click(),!0):(13!=t&&27!=t||32!=t||13!=t&&32!=t||document.activeElement.getAttribute("aria-label").click(),!0)};const n=e=>{let t=this.getCalendar(),i=parseInt(e.target.innerHTML),n=t.dataset.current.split("-");i=new Date(n[0],n[1],i);let r=window[this.source.dataset.onset];r&&r(i);let a=i.getMonth()+1;1===a.toString().length&&(a="0"+a);let s=i.getDate();1===s.toString().length&&(s="0"+s);let l=[i.getFullYear(),a,s].join("-");return"INPUT"===this.source.nodeName?(this.source.value=l,"InputEvent"in window?this.source.dispatchEvent(new InputEvent("input")):this.source.dispatchEvent(new Event("input"))):this.source.dataset.dateVal&&(this.source.dataset.dateVal=l),this.callback&&this.callback(this.source,l),this.cleanupCalendar(e,t)},r=()=>{this.getCalendar()&&Array.prototype.slice.call(document.querySelectorAll("#dz-calendar .dz-dates button")).forEach(e=>{e.classList.contains("disabled")||e.addEventListener("click",n,!1)})},a=e=>{let n=this.getCalendar();if(n)return this.cleanupCalendar(e,n),setTimeout(()=>{a(e)},350),!1;let s=e.target.getBoundingClientRect(),l=s.left+s.width/2,o=s.top+s.height,d="INPUT"===e.target.nodeName?e.target:findParent(e.target,this.customClass||"date-trigger");this.source=d;let u=this.drawCalendar();return mutate(()=>{document.body.insertAdjacentHTML("beforeEnd",u)}).then(()=>(u=document.getElementById("dz-calendar"),measure(()=>u.getBoundingClientRect()))).then(e=>{let n=4*e.width;u.style.left=l-n/2+"px",u.style.top=o-s.height+"px";let r=u.children[0].children[1],a=u.children[0].children[2];return r.addEventListener("click",t,!1),a.addEventListener("click",i,!1),mutate(()=>{u.classList.add("active"),this.source.setAttribute("aria-expanded","true"),this.source.hasAttribute("id")&&u.setAttribute("aria-describedby",this.source.getAttribute("id"))})}).then(()=>{r();let e="didShowDatePicker";window[e]&&window[e](u)}).then(()=>{let e=new Date;return this.source.hasAttribute("value")&&this.source.value&&this.source.value.trim().length&&(e=new Date(this.source.value)),e=e.getDate(),measure(()=>u.querySelector(`button:nth-child(${e})`))}).then(e=>{e&&e.focus(),document.body.addEventListener("click",this.bodyClick,!1),document.body.addEventListener("keydown",this.bodyInput,!1)}).then(e=>{setTimeout(()=>{this.repositionCalendarWithinViewport()},100)}).catch(e=>{console.error(e)}),!1};let s=document.querySelectorAll(this.customClass?"."+this.customClass:".date-trigger");s=Array.prototype.slice.call(s);const l=e=>{e&&(e.addEventListener("click",a,!1),"INPUT"===e.nodeName&&(e.addEventListener("focus",inputFocus,!1),e.addEventListener("blur",inputBlur,!1),e.setAttribute("aria-haspopup","true"),e.setAttribute("aria-expanded","false")))};s.forEach(e=>{l(e)}),e.attachDateTrigger=l}getCalendar(){return document.getElementById("dz-calendar")}isInCalendar(e){let t=findParent(e,"dz-calendar");return t!==document.body&&null!=t}getMonthName(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].splice(e,1)}getFullMonthName(e){return["January","February","March","April","May","June","July","August","September","October","November","December"].splice(e,1)}getDaysArrayByMonth(e){let t=e.getFullYear(),i=e.getMonth(),n=new Date(t,i+1,0).getDate(),r=[];for(;n>0;)r.push(new Date(t,i,n)),n--;return r.reverse()}drawDates(e){let t=new Date,i=new Date;"INPUT"===this.source.nodeName&&this.source.value?t=new Date(this.source.value):this.source.dataset.dateVal&&(t=new Date(this.source.dataset.dateVal));let n='<div class="dz-dates">',{dateMax:r,dateMin:a}=(this.getCalendar(),this.source.dataset);r&&(r=new Date(r)),a&&(a=new Date(a));let s=null;"INPUT"===this.source.nodeName?s=new Date(this.source.value):this.source.dataset.dateVal&&(s=new Date(this.source.dataset.dateVal));let l=e[0].getDay();const o=(e,t)=>e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getYear()==t.getYear();return e.forEach((e,t)=>{let d=[];o(i,e)&&d.push("today"),s&&o(e,s)&&d.push("selected"),a&&a.getTime()-e.getTime()>0&&d.push("disabled"),r&&r.getTime()-e.getTime()<0&&d.push("disabled"),console.debug(d),d=d.join(" ");let u=e.toDateString();u=[u.substr(0,3),u.substr(4)],u[0]=`${{Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday",Sat:"Saturday",Sun:"Sunday"}[u[0]]}, `,u[1]=[u[1].substr(0,3),u[1].substr(4)],u[1][0]=this.getFullMonthName(e.getMonth()),u[1]=u[1].join(" "),u=u.join(""),n+=0!==t?`<button aria-label="${u}" class="${d}">${e.getDate()}</button>`:`<button style="margin-left:${36*l}px;" aria-label="${u}" class="${d}">${e.getDate()}</button>`}),n+="</div>",n}drawCalendar(){let e=new Date;this.source.hasAttribute("value")&&this.source.value&&this.source.value.trim().length&&(e=new Date(this.source.value));let t=e.getFullYear(),i=e.getMonth(),n=this.getDaysArrayByMonth(e),r=`<div id="dz-calendar" class="inline-container" data-current="${t}-${i}"  role="dialog" aria-label="Calendar">\n        <div class="dz-title">\n           <h4 aria-role="Presentation" aria-label="${this.getFullMonthName(e.getMonth())}, ${e.getFullYear()}">${this.getMonthName(e.getMonth())}, ${e.getFullYear()}</h4>\n           <button id="dz-prev" aria-label="Previous Month" title="Previous Month"><svg aria-hidden="true" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Previous Month</title><path d="M14.422 16.078l-1.406 1.406-6-6 6-6 1.406 1.407-4.594 4.593z" fill="#007AFF" fill-rule="evenodd"/></svg></button></button>\n           <button id="dz-next" aria-label="Next Month" title="Next Month"><svg aria-hidden="true" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Next Month</title><path d="M8.578 16.36l4.594-4.594-4.594-4.594 1.406-1.406 6 6-6 6z" fill="#007AFF" fill-rule="evenodd"/></svg></button>\n        </div>\n        <div class="dz-days">`;return["S","M","T","W","T","F","S"].forEach(e=>{r+=`<div>${e}</div>`}),r+=`</div>\n        ${this.drawDates(n)}\n      </div>`,r}repositionCalendarWithinViewport(){const t=this.getCalendar();if(!t)return;const i=t.getBoundingClientRect();if(i.x<0){const e=i.x-Number(t.style.left.replace("px",""))-8;t.style.left=e+"px",t.classList.add("zp-l")}if(i.x+i.width>e.innerWidth){const n=e.innerWidth-i.width-48;t.style.left=n+"px",t.classList.add("zp-r");const r=t.parentNode.querySelector("#dz-calendar",":before");console.log(r.style.left)}}cleanupCalendar(e,t){return e&&e.preventDefault&&e.preventDefault(),t&&mutate(()=>{t.classList.remove("active")}).then(()=>wait(300)).then(()=>{t&&t.parentNode&&t.parentNode.removeChild(t)}).then(()=>this.source?mutate(()=>this.source.setAttribute("aria-expanded","false")):Promise.resolve()).then(()=>{document.body.removeEventListener("click",this.bodyClick,!1),document.body.removeEventListener("keydown",this.bodyInput,!1)}).catch(e=>{console.error(e)}),!1}}e&&e.exports?e.exports=Object.assign({},{DatePicker:t,datePicker:new t}):(e.DatePicker=t,e.datePicker=new t)})("undefined"==typeof module?window:module),(e=>{class t{constructor(){this.init()}init(){if(this.initialized)return!1;this.initialized=!0,this.setupHooks()}setupHooks(){this.bodyClick=e=>{if("SELECT"===e.target.nodeName)return!1;let t=this.getTimer();if(t)if(t.classList.contains("active")){if(!this.isInTimer(e.target))return this.cleanupTimer(e,t)}else document.body.removeChild(t);document.body.removeEventListener("click",this.bodyClick,!1)},this.bodyInput=e=>{const{keyCode:t}=e;return 13!=t&&27!=t||(27==t&&this.hasOwnProperty("originalValue")&&(this.source.value=this.originalValue),this.hasOwnProperty("originalValue")&&this.originalValue,this.cleanupTimer(void 0,this.getTimer())),!0};const e=()=>{let e=this.getTimer(),t=parseInt(e.children[0].value),i=parseInt(e.children[1].value),n=parseInt(e.children[2].value);1===n&&12!=t&&(t+=12),12===t&&0===n&&(t="00"),"INPUT"===this.source.nodeName&&(this.source.value=t+":"+i,"InputEvent"in window?this.source.dispatchEvent(new InputEvent("input")):this.source.dispatchEvent(new Event("input")));let r=window[this.source.dataset.onchange];r&&r({string:t+":"+i,hours:parseInt(t),minutes:i})},t=i=>{let n=this.getTimer();if(n)return this.cleanupTimer(i,n),setTimeout(()=>{t(i)},300),!1;let r=i.target.getBoundingClientRect(),a=r.left,s=r.top+r.height;this.source=i.target;let l=this.drawTimer();return mutate(()=>{document.body.insertAdjacentHTML("beforeEnd",l)}).then(()=>{if(l=this.getTimer(),"INPUT"!==this.source.nodeName||!this.source.value.length){let e=new Date,t=e.getHours(),i=e.getMinutes();return mutate(()=>{l.children[0].value=t>12?t-12:t,l.children[1].value=i,l.children[2].value=t>=12?1:0})}return Promise.resolve()}).then(()=>(Array.prototype.slice.call(l.children).forEach(t=>{t.addEventListener("change",e,!1)}),measure(()=>l.getBoundingClientRect()))).then(e=>{e.width;return l.style.left=a-16+"px",l.style.top=s+"px",mutate(()=>{l.classList.add("active"),this.source.setAttribute("aria-expanded","true"),this.source.hasAttribute("id")&&l.setAttribute("aria-describedby",this.source.getAttribute("id"))})}).then(()=>{l.querySelector("select").focus(),this.originalValue=this.source.value,document.body.addEventListener("click",this.bodyClick,!1),document.body.addEventListener("keydown",this.bodyInput,!1)}).catch(e=>{console.error(e)}),!1},i=e=>{e&&(e.addEventListener("click",t,!1),"INPUT"===e.nodeName&&(e.addEventListener("focus",inputFocus,!1),e.addEventListener("blur",inputBlur,!1),e.setAttribute("aria-haspopup","true"),e.setAttribute("aria-expanded","false")))};Array.prototype.slice.call(document.querySelectorAll(".timer-trigger")).forEach(e=>{i(e)}),window.attachTimeTrigger=i}getTimer(){return document.getElementById("dz-timer")}isInTimer(e){let t=findParent(e,"dz-timer");return t!==document.body&&null!=t}drawTimer(){let e,t,i=null,n=!1;"INPUT"===this.source.nodeName&&(i=this.source.value),i&&(i=i.split(":"),e=parseInt(i[0]),t=i[1],e>=12&&(n=!0));let r='<div id="dz-timer" class="inline-container" role="dialog" aria-label="Time picker">\n        <select class="hours">',a=Array.from(Array(13).keys());return a.shift(),r+=a.map(t=>t===e?`<option value='${t}' selected='selected'>${t}</option>`:`<option value='${t}'>${t}</option>`).join(" "),r+='</select>\n        <select class="minutes">',r+=Array.from(Array(60).keys()).map(e=>(1===e.toString().length&&(e="0"+e),e.toString()===t?`<option value='${e}' selected='selected'>${e}</option>`:`<option value='${e}'>${e}</option>`)).join(" "),r+=`</select>\n        <select class="shift">\n          <option value='0' ${n?"":"selected='selected'"}>AM</option>\n          <option value='1' ${n?"selected='selected'":""}>PM</option>\n        </select>`,r+="</select>\n      </div>",r}cleanupTimer(e,t){return e&&e.preventDefault&&e.preventDefault(),t&&mutate(()=>{t.classList.remove("active")}).then(()=>wait(500)).then(()=>{this.source=void 0,t.parentNode&&document.body.removeChild(t)}).catch(e=>{console.error(e)}),document.body.removeEventListener("click",this.bodyClick,!1),document.body.removeEventListener("keydown",this.bodyInput,!1),!1}}e&&e.exports?e.exports=Object.assign({},{TimePicker:t,timePicker:new t}):(e.TimePicker=t,e.timePicker=new t)})("undefined"==typeof module?window:module),(e=>{class t{constructor(e){this.elem=e,this.initialized=!1,this.init()}init(){if(!this.elem)return;if(this.initialized)return;this.initialized=!0;let e=+new Date;this.startElem=this.elem.querySelector(".range-start"),this.endElem=this.elem.querySelector(".range-end"),this.startElem.setAttribute("type","text"),this.endElem.setAttribute("type","text"),this.startElem.classList.add("start"+e),this.endElem.classList.add("end"+e),this.startController=new DatePicker("start"+e),this.endController=new DatePicker("end"+e),this.startController.callback=this.callback.bind(this),this.endController.callback=this.startController.callback}callback(){let e=[...arguments],t=e[1],i=e[0].classList.contains("range-start");i?this.start=t:this.end=t,i?this.endElem.dataset.dateMin=t:this.startElem.dataset.dateMax=t}}e.hasOwnProperty("exports")?e.exports=Object.assign({},e.exports,t):e.RangePicker=t})("undefined"==typeof module?window:module),(e=>{if(!e)return;let t={date:!1,time:!1,"datetime-local":!1},i=document.createElement("input");Object.keys(t).forEach(e=>{i.type=e,t[e]=i.type===e});const n=/([\d]{4}\-[\d]{2}\-[\d]{2})T([\d]{2}\:[\d]{2})/,r=()=>{Array.prototype.slice.call(document.querySelectorAll('input[type="time"]')).forEach(attachTimeTrigger)},a=()=>{Array.prototype.slice.call(document.querySelectorAll('input[type="date"]')).forEach(attachDateTrigger)},s=()=>{Array.prototype.slice.call(document.querySelectorAll('input[type="datetime-local"]')).forEach(e=>{const i=e,r=i.parentNode,a=()=>r.querySelector("input[data-original='datetime-local']");let s=i.value,l=null,o=null;s.trim().length>0&&n.test(s)&&(l=s.replace(n,"$1"),o=s.replace(n,"$2"));i.__defineGetter__("value",(function(){return((this.dataset.date||"")+" "+(this.dataset.time||"")).trim()})),i.type="hidden",i.dataset.original="datetime-local";let d=document.createElement("input");d.type=t.date?"date":"text",d.placeholder="Date",d.oninput=e=>{a().dataset.date=e.target.value},l&&(d.value=l);let{dateMin:u,dateMax:c}=i.dataset;u&&(d.dataset.dateMin=u),c&&(d.dataset.dateMax=c);let h=document.createElement("input");h.type=t.time?"time":"text",h.placeholder="Time",h.oninput=e=>{a().dataset.time=e.target.value},o&&(h.value=o),[d,h].forEach(e=>{e.__defineGetter__("required",(function(){return i.required})),e.__defineGetter__("validity",(function(){return i.validity})),e.__defineGetter__("pattern",(function(){return i.pattern})),e.__defineGetter__("validationMessage",(function(){return i.validationMessage})),e.__defineSetter__("validationMessage",(function(e){i.validationMessage=e}))}),r.insertAdjacentElement("beforeEnd",d),r.insertAdjacentElement("beforeEnd",h),attachDateTrigger(d),attachTimeTrigger(h)})};t.date||a(),t.time||r(),t["datetime-local"]||s(),e.hookDate=a,e.hookTime=r,e.hookDateTimer=s})("undefined"==typeof module?window:void 0);
//# sourceMappingURL=dzdatetimepicker-dist.js.map