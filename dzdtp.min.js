"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){var t=Array.prototype.slice,n=function(e,t){var n=function(e){return e.getAttribute("id")===t||e.classList.contains(t)};if(n(e))return e;for(;e.parentNode;){if(e=e.parentNode,e===document.body||e===document)return void 0;if(n(e))return e}return void 0},r=function(e){return e&&e.preventDefault&&e.preventDefault(),e.target.blur(),!1},a=function(e){return e&&e.preventDefault&&e.preventDefault(),!1},i=function(){function i(){_classCallCheck(this,i),this.init()}return _createClass(i,[{key:"init",value:function(){return this.initialized?!1:(this.initialized=!0,void this.setupHooks())}},{key:"setupHooks",value:function(){var i=this,o=function(e){e&&e.preventDefault&&e.preventDefault();var t=i.getCalendar(),n=t.dataset.current.split("-"),r=new Date(n[0],n[1]),a=new Date(r.getFullYear(),r.getMonth()-1),o=i.drawDates(i.getDaysArrayByMonth(a)),d=document.querySelector("#dz-calendar .dz-dates");t.insertAdjacentHTML("beforeEnd",o),o=t.children[t.children.length-1],t.removeChild(d);var l=a.getFullYear(),u=a.getMonth();return t.dataset.current=l+" - "+u,t.children[0].children[0].innerHTML=i.getMonthName(u)+", "+l,c(),!1},d=function(e){e&&e.preventDefault&&e.preventDefault();var t=i.getCalendar(),n=t.dataset.current.split("-"),r=new Date(n[0],n[1]),a=new Date(r.getFullYear(),r.getMonth()+1),o=i.drawDates(i.getDaysArrayByMonth(a)),d=document.querySelector("#dz-calendar .dz-dates");t.insertAdjacentHTML("beforeEnd",o),o=t.children[t.children.length-1],t.removeChild(d);var l=a.getFullYear(),u=a.getMonth();return t.dataset.current=l+" - "+u,t.children[0].children[0].innerHTML=i.getMonthName(u)+", "+l,c(),!1};this.bodyClick=function(e){var t=i.getCalendar();if(t)if(t.classList.contains("active")){if(!i.isInCalendar(e.target))return i.cleanupCalendar(e,t)}else document.body.removeChild(t)};var l=function(e){var t=i.getCalendar(),n=parseInt(e.target.innerHTML),r=t.dataset.current.split("-");n=new Date(r[0],r[1],n);var a=window[i.source.dataset.onset];a&&a(n);var o=n.getMonth()+1;1===o.toString().length&&(o="0"+o);var d=n.getDate();1===d.toString().length&&(d="0"+d);var l=[n.getFullYear(),o,d].join("-");return"INPUT"===i.source.nodeName?(i.source.value=l,"InputEvent"in window&&i.source.dispatchEvent(new InputEvent("input"))):i.source.dataset.dateVal&&(i.source.dataset.dateVal=l),i.cleanupCalendar(e,t)},c=function(){var e=i.getCalendar();if(e){var n=t.call(document.querySelectorAll("#dz-calendar .dz-dates div"));n.forEach(function(e){e.classList.contains("disabled")||e.addEventListener("click",l,!1)})}},u=function h(e){var t=i.getCalendar();if(t)return i.cleanupCalendar(e,t),setTimeout(function(){h(e)},300),!1;var r=e.target.getBoundingClientRect(),a={x:r.left+r.width/2,y:r.top+r.height},l=n(e.target,"date-trigger");i.source=l;var u=i.drawCalendar();document.body.insertAdjacentHTML("beforeEnd",u),u=document.getElementById("dz-calendar");var s=u.getBoundingClientRect(),v=4*s.width;u.style.left=a.x-v/2+"px",u.style.top=a.y+16+"px";var f=u.children[0].children[1],g=u.children[0].children[2];f.addEventListener("click",o,!1),g.addEventListener("click",d,!1),u.classList.add("active"),c();var m="didShowDatePicker";return window[m]&&window[m](u),setTimeout(function(){document.body.addEventListener("click",i.bodyClick,!1)},500),!1},s=document.querySelectorAll(".date-trigger");s=t.call(s);var v=function(e){e&&(e.addEventListener("click",u,!1),"INPUT"===e.nodeName&&(e.addEventListener("focus",r,!1),e.addEventListener("blur",a,!1)))};s.forEach(function(e){v(e)}),e.attachDateTrigger=v}},{key:"getCalendar",value:function(){return document.getElementById("dz-calendar")}},{key:"isInCalendar",value:function(e){var t=n(e,"dz-calendar");return t!==document.body&&void 0!=t}},{key:"getMonthName",value:function(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].splice(e,1)}},{key:"getDaysArrayByMonth",value:function(e){for(var t=e.getFullYear(),n=e.getMonth(),r=new Date(t,n,0).getDate(),a=[];r>0;)a.push(new Date(t,n,r)),r--;return a.reverse()}},{key:"drawDates",value:function(e){var t=new Date;"INPUT"===this.source.nodeName&&this.source.value?t=new Date(this.source.value):this.source.dataset.dateVal&&(t=new Date(this.source.dataset.dateVal));var n='<div class="dz-dates">',r=(this.getCalendar(),this.source.dataset),a=r.dateMax,i=r.dateMin;a&&(a=new Date(a)),i&&(i=new Date(i));var o=null;"INPUT"===this.source.nodeName?o=new Date(this.source.value):this.source.dataset.dateVal&&(o=new Date(this.source.dataset.dateVal));var d=e[0].getDay(),l=function(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getYear()&&t.getYear()};return e.forEach(function(e,r){var c=[];l(t,e)&&c.push("today"),o&&l(e,o)&&c.push("selected"),i&&i.getTime()-e.getTime()>0&&c.push("disabled"),a&&a.getTime()-e.getTime()<0&&c.push("disabled"),c=c.join(" "),n+=0!==r?'<div role="button" class="'+c+'">'+e.getDate()+"</div>":'<div style="margin-left:'+35*d+'px;" role="button" class="'+c+'">'+e.getDate()+"</div>"}),n+="</div>"}},{key:"drawCalendar",value:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth(),r=this.getDaysArrayByMonth(e),a=["S","M","T","W","T","F","S"],i='<div id="dz-calendar" class="inline-container" data-current="'+t+"-"+n+'">\n        <div class="dz-title"> \n           <h4>'+this.getMonthName(e.getMonth())+", "+e.getFullYear()+'</h4>\n           <button id="dz-prev"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>keyboard_arrow_left</title><path d="M14.422 16.078l-1.406 1.406-6-6 6-6 1.406 1.407-4.594 4.593z" fill="#8FCB14" fill-rule="evenodd"/></svg></button>\n           <button id="dz-next"><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>keyboard_arrow_right</title><path d="M8.578 16.36l4.594-4.594-4.594-4.594 1.406-1.406 6 6-6 6z" fill="#8FCB14" fill-rule="evenodd"/></svg></button>\n        </div>\n        <div class="dz-days">';return a.forEach(function(e){i+="<div>"+e+"</div>"}),i+="</div>\n        "+this.drawDates(r)+"\n      </div>"}},{key:"cleanupCalendar",value:function(e,t){var n=this;return e&&e.preventDefault&&e.preventDefault(),t&&(t.classList.remove("active"),setTimeout(function(){document.body.removeChild(t),n.source=void 0},300)),document.body.removeEventListener("click",this.bodyClick,!1),!1}}]),i}(),o=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"init",value:function(){return this.initialized?!1:(this.initialized=!0,void this.setupHooks())}},{key:"setupHooks",value:function(){var e=this;this.bodyClick=function(t){if("SELECT"===t.target.nodeName)return!1;var n=e.getTimer();if(n)if(n.classList.contains("active")){if(!e.isInTimer(t.target))return e.cleanupTimer(t,n)}else document.body.removeChild(n);document.body.removeEventListener("click",e.bodyClick,!1)};var n=function(){var t=e.getTimer(),n=parseInt(t.children[0].value),r=parseInt(t.children[1].value),a=parseInt(t.children[2].value);1===a&&(n+=12),12===n&&0===a&&(n="00"),"INPUT"===e.source.nodeName&&(e.source.value=n+":"+r,"InputEvent"in window&&e.source.dispatchEvent(new InputEvent("input")));var i=window[e.source.dataset.onchange];i&&i({string:n+":"+r,hours:parseInt(n),minutes:r})},i=function l(r){var a=e.getTimer();if(a)return e.cleanupTimer(r,a),setTimeout(function(){l(r)},300),!1;var i=r.target.getBoundingClientRect(),o={x:i.left+i.width/2,y:i.top+i.height};e.source=r.target;var d=e.drawTimer();if(document.body.insertAdjacentHTML("beforeEnd",d),d=e.getTimer(),"INPUT"!==e.source.nodeName||!e.source.value.length){var c=new Date,u=c.getHours(),s=c.getMinutes();d.children[0].value=u>12?u-12:u,d.children[1].value=s,d.children[2].value=u>=12?1:0}t.call(d.children).forEach(function(e){e.addEventListener("change",n,!1)});var v=d.getBoundingClientRect(),h=4*v.width;return d.style.left=o.x-h/2+"px",d.style.top=o.y+16+"px",d.classList.add("active"),setTimeout(function(){document.body.addEventListener("click",e.bodyClick,!1)},500),!1},o=function(e){e&&(e.addEventListener("click",i,!1),"INPUT"===e.nodeName&&(e.addEventListener("focus",r,!1),e.addEventListener("blur",a,!1)))},d=t.call(document.querySelectorAll(".timer-trigger"));d.forEach(function(e){o(e)}),window.attachTimeTrigger=o}},{key:"getTimer",value:function(){return document.getElementById("dz-timer")}},{key:"isInTimer",value:function(e){var t=n(e,"dz-timer");return t!==document.body&&void 0!=t}},{key:"drawTimer",value:function(){var e=null,t=void 0,n=void 0,r=!1;"INPUT"===this.source.nodeName&&(e=this.source.value),e&&(e=e.split(":"),t=parseInt(e[0]),n=e[1],t>12&&(t-=12,r=!0));var a='<div id="dz-timer" class="inline-container">\n        <select class="hours">',i=Array.from(Array(13).keys());return i.shift(),a+=i.map(function(e){return e===t?"<option value='"+e+"' selected='selected'>"+e+"</option>":"<option value='"+e+"'>"+e+"</option>"}).join(" "),a+='</select>\n        <select class="minutes">',a+=Array.from(Array(60).keys()).map(function(e){return 1===e.toString().length&&(e="0"+e),e.toString()===n?"<option value='"+e+"' selected='selected'>"+e+"</option>":"<option value='"+e+"'>"+e+"</option>"}).join(" "),a+="</select>\n        <select class=\"shift\">\n          <option value='0' "+(r?"":"selected='selected'")+">AM</option>\n          <option value='1' "+(r?"selected='selected'":"")+">PM</option>\n        </select>",a+="</select>\n      </div>"}},{key:"cleanupTimer",value:function(e,t){var n=this;return e&&e.preventDefault&&e.preventDefault(),t&&(t.classList.remove("active"),setTimeout(function(){n.source=void 0,t.parentNode&&document.body.removeChild(t)},300)),document.body.removeEventListener("click",this.bodyClick,!1),!1}}]),e}();e&&e.exports?e.exports={datePicker:new i,timePicker:new o}:(e.DZDatePicker=i,e.DZTimePicker=o,e.datePicker=new i,e.timePicker=new o)}("undefined"==typeof module?window:module);